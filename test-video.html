
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Video - Capisco</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 2rem; }
        .test-section { margin: 2rem 0; padding: 1rem; border: 1px solid #ccc; border-radius: 8px; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        button { padding: 0.5rem 1rem; margin: 0.5rem; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        #results { margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Capisco Test - Video ID: EtATCGgoo9U</h1>
    
    <div class="test-section">
        <h2>Video URL Test</h2>
        <p><strong>Your URL:</strong> https://youtu.be/EtATCGgoo9U?si=qoquxs_RoZ-1mEy4</p>
        <button onclick="testVideoId()">Test Video ID Extraction</button>
        <button onclick="testCapiscoLoad()">Test Capisco Loading</button>
        <button onclick="testFullProcess()">Test Full Process</button>
    </div>
    
    <div id="results"></div>
    
    <script type="text/javascript" src="capisco-engine.js"></script>
    <script>
        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.style.margin = '0.5rem 0';
            div.style.padding = '0.5rem';
            div.style.borderRadius = '4px';
            
            if (type === 'success') {
                div.style.background = '#d4edda';
                div.style.color = '#155724';
            } else if (type === 'error') {
                div.style.background = '#f8d7da';
                div.style.color = '#721c24';
            } else {
                div.style.background = '#e2e3e5';
                div.style.color = '#383d41';
            }
            
            div.innerHTML = `<strong>[${new Date().toLocaleTimeString()}]</strong> ${message}`;
            results.appendChild(div);
            results.scrollTop = results.scrollHeight;
        }
        
        function testVideoId() {
            log('Testing video ID extraction...');
            const url = 'https://youtu.be/EtATCGgoo9U?si=qoquxs_RoZ-1mEy4';
            
            if (window.capisco && window.capisco.extractVideoId) {
                const videoId = window.capisco.extractVideoId(url);
                if (videoId === 'EtATCGgoo9U') {
                    log(`âœ… Video ID extracted correctly: ${videoId}`, 'success');
                } else {
                    log(`âŒ Video ID extraction failed. Got: ${videoId}`, 'error');
                }
            } else {
                log('âŒ Capisco not loaded or extractVideoId method not found', 'error');
            }
        }
        
        function testCapiscoLoad() {
            log('Testing Capisco loading...');
            
            if (window.capisco) {
                log('âœ… Capisco object found', 'success');
                log(`âœ… Capisco constructor: ${typeof window.capisco.constructor.name}`, 'success');
                
                if (window.capisco.extractVideoId) log('âœ… extractVideoId method found', 'success');
                if (window.capisco.generateLesson) log('âœ… generateLesson method found', 'success');
                if (window.capisco.extractTranscript) log('âœ… extractTranscript method found', 'success');
                
            } else {
                log('âŒ Capisco object not found', 'error');
                log('Available window properties: ' + Object.keys(window).filter(k => k.toLowerCase().includes('cap')).join(', '));
            }
        }
        
        async function testFullProcess() {
            log('Testing full process with demo transcript...');
            
            if (!window.capisco) {
                log('âŒ Capisco not loaded', 'error');
                return;
            }
            
            try {
                const videoId = 'EtATCGgoo9U';
                log(`âœ… Using video ID: ${videoId}`, 'success');
                
                // Test transcript extraction
                log('ðŸ”„ Testing transcript extraction...');
                const transcript = await window.capisco.extractYouTubeTranscript(`https://youtube.com/watch?v=${videoId}`);
                
                if (transcript && transcript.length > 0) {
                    log(`âœ… Transcript extracted: ${transcript.length} characters`, 'success');
                    log(`ðŸ“ First 100 chars: ${transcript.substring(0, 100)}...`);
                } else {
                    log('âŒ No transcript extracted', 'error');
                }
                
            } catch (error) {
                log(`âŒ Error in full process test: ${error.message}`, 'error');
                console.error('Full test error:', error);
            }
        }
        
        // Auto-run basic tests when page loads
        document.addEventListener('DOMContentLoaded', function() {
            log('ðŸš€ Page loaded, running basic tests...');
            setTimeout(() => {
                testCapiscoLoad();
                testVideoId();
            }, 1000);
        });
    </script>
</body>
</html>
