<!doctype html>
<html lang="en">
  <head>
    <!-- __START_META_S010__ -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- __END_META_S010__ -->

    <!-- __START_TITLE_S020__ -->
    <title>Seasons Card Demo (Phase 6C)</title>
    <!-- __END_TITLE_S020__ -->

    <!-- __START_CSS_LINKS_S030__ -->
    <link rel="stylesheet" href="../../style-seasons-card.css" />
    <!-- __END_CSS_LINKS_S030__ -->

    <!-- __START_DEMO_STYLES_S500__ -->
    <style>
/* __START_PAGE_BASE_S510__ */

:root{
  --demo-gap: 24px;
  --demo-card-max: 980px;
}

/* outer page container */
.page{
  width: 100%;
  max-width: 1600px;
  margin: 0 auto;
  box-sizing: border-box;
}

/* main demo mount: centered at all widths */
#mount{
  display: grid;
  gap: var(--demo-gap);

  width: 100%;
  max-width: calc((var(--demo-card-max) * 2) + var(--demo-gap));
  margin: 0 auto;

  /* 1-up default */
  grid-template-columns: minmax(0, var(--demo-card-max));
  justify-content: center;

  box-sizing: border-box;
}

#mount > *{
  min-width: 0;
  width: 100%;
  max-width: var(--demo-card-max);
  justify-self: center;
}

/* 2-up */
@media (min-width: 1300px){
  #mount{
    grid-template-columns: repeat(2, minmax(0, var(--demo-card-max)));
  }
}

/* -----------------------------
   MEDIA CLIP FIX (1366+ issue)
   -----------------------------
   Goal: when the card goes “image-on-right”, the media column MUST be able
   to shrink, and the <img> must scale to the media box.
*/
.card-image{
  min-width: 0 !important;
  max-width: 100% !important;
  box-sizing: border-box !important;
}

/* clamp the *column* so it never forces overflow in 2-up widths */
@media (min-width: 1100px){
  .card-image{
    width: auto !important;
    max-width: clamp(220px, 30vw, 360px) !important;
    justify-self: end;
  }
}

.card-image .capisco-card-media{
  width: 100% !important;
  max-width: 100% !important;
  box-sizing: border-box !important;
}

/* the actual image must never exceed its container */
.card-image .capisco-card-media img{
  display: block;
  width: 100% !important;
  max-width: 100% !important;
  height: auto !important;
  object-fit: cover;
}

/* __END_PAGE_BASE_S510__ */







/* __START_IMAGE_LAYOUT_S600__ */
/*
  Demo media layout tuning (no absolute positioning):
  States:
  A) Mobile/skinny: stacked, image not crazy huge
  B) Mid/desktop 1-up: side-by-side sooner, image reasonably big
  C) 2-up: protect text column from being squashed (image shrinks a bit)
*/

/* keep hidden icon behavior */
.icon-circle.hidden {
  display: none !important;
}

/* Default image size variable (1-up desktop) */
:root {
  --capisco-card-image-size: clamp(240px, 22vw, 360px);
}

/* Card becomes a grid for predictable media placement */
.card {
  display: grid;
  grid-template-columns: 1fr;
  grid-template-areas:
    "header"
    "media"
    "tabs"
    "body";
}

.card-header { grid-area: header; }
.card-image  { grid-area: media; }
.tabs        { grid-area: tabs; }
.card-body   { grid-area: body; }

/* A) Mobile/skinny: stacked, but cap the growth */
.card-image {
  width: min(100%, clamp(260px, 78vw, 560px));
  height: auto;
  margin: 12px 0 0 0;
}

/* B) Mid widths: switch to side-by-side earlier to avoid “super long” */
@media (min-width: 900px) {
  .card {
    grid-template-columns: minmax(420px, 1fr) var(--capisco-card-image-size);
    grid-template-areas:
      "header media"
      "tabs   media"
      "body   media";
    column-gap: 18px;
    align-items: start;
  }

  .card-image {
    width: var(--capisco-card-image-size);
    margin: 18px 18px 0 0;
  }
}

/* B2) Larger 1-up desktop: allow a bit more image */
@media (min-width: 1200px) {
  :root {
    --capisco-card-image-size: clamp(260px, 24vw, 420px);
  }
}

/* C) 2-up protection:
   When the overall viewport is wide enough for 2-up, each card is narrower.
   Reduce image size so text doesn’t get crushed.
*/
@media (min-width: 1300px) {
  :root {
    --capisco-card-image-size: clamp(220px, 18vw, 320px);
  }

  .card {
    grid-template-columns: minmax(0, 1fr) var(--capisco-card-image-size);
  }
}
/* __END_IMAGE_LAYOUT_S600__ */




      /* ===============================
         IMAGE_SHADOW_S610
         =============================== */
      /* __START_IMAGE_SHADOW_S610__ */
      .capisco-card-media,
      .card-media,
      .media,
      [data-media-slot],
      [data-media],
      [data-media-slot] > .capisco-card-media {
        border-radius: 14px;
        overflow: hidden;
        background: #fff;
        box-shadow: 0 12px 28px rgba(15, 23, 42, 0.22);
      }

      img.capisco-card-image,
      .capisco-card-media img,
      .card-media img,
      .media img,
      [data-media-slot] img,
      [data-media] img {
        display: block;
        width: 100%;
        height: auto;
        object-fit: contain;
        background: #fff;
        border-radius: 0;
        box-shadow: none;
      }

      @media (min-width: 900px) {
        .capisco-card-media,
        .card-media,
        .media,
        [data-media-slot],
        [data-media] {
          max-width: 340px;
        }
      }
      /* __END_IMAGE_SHADOW_S610__ */
    </style>
    <!-- __END_DEMO_STYLES_S500__ -->
  </head>

  <!-- __START_BODY_S100__ -->
  <body>
    <!-- __START_MAIN_S110__ -->
    <main class="page">
      <!-- __START_HEADER_S120__ -->
      <h1 style="margin: 24px 0 8px">Seasons Card Demo</h1>
      <p class="page-intro" style="margin-bottom: 24px">
        Reference demo page. Loads a canonical card JSON and renders it.
        Phase 6C focuses on demo layout stability (1-up → 2-up).
      </p>
      <!-- __END_HEADER_S120__ -->

      <!-- __START_MOUNT_S130__ -->
      <div id="mount"></div>
      <!-- __END_MOUNT_S130__ -->
    </main>
    <!-- __END_MAIN_S110__ -->

    <!-- __START_RENDERER_SCRIPT_TAG_S200__ -->
    <script src="./render.js"></script>
    <!-- __END_RENDERER_SCRIPT_TAG_S200__ -->

    <!-- __START_BOOTSTRAP_SCRIPT_S300__ -->
    <script>
      /* __START_HELPERS_S310__ */
      function showError(container, err) {
        console.error(err);
        container.innerHTML =
          '<pre style="color:#b00020; padding:16px; background:#fff; border-radius:12px;">' +
          String(err) +
          "</pre>";
      }

      async function loadJson(url) {
        const res = await fetch(url, { cache: "no-store" });
        if (!res.ok) {
          throw new Error("Failed to load JSON: " + url);
        }
        return res.json();
      }
      /* __END_HELPERS_S310__ */

      /* __START_MAIN_S320__ */
      async function main() {
        const container = document.getElementById("mount");
        const card = await loadJson("./cards/stagione.card.json");

        // Start with 2 cards (safe baseline)
        window.CapiscoSeasonsCard.renderMany(container, [card, card]);
      }
      /* __END_MAIN_S320__ */

      /* __START_RUN_S330__ */
      main().catch((err) => {
        showError(document.getElementById("mount"), err);
      });
      /* __END_RUN_S330__ */
    </script>
    <!-- __END_BOOTSTRAP_SCRIPT_S300__ -->
  </body>
  <!-- __END_BODY_S100__ -->
</html>
